{% extends "base.html" %}
{% block title %}Benford's Law Analyzer{% endblock %}
{% block content %}
<div class="card" id="learn">
    <div style="display:flex; flex-wrap:wrap; gap:20px; align-items:center;">
        <div style="flex:1 1 320px;">
            <h1 style="margin-bottom:8px;">Test and Learn Benford's Law</h1>
            <p class="muted" style="margin-bottom:12px;">Upload a CSV, preview your data, and see how its leading digits compare to Benford's expected distribution.</p>
            <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:16px;">
                <span class="pill pill-green">Upload or use examples</span>
                <span class="pill pill-amber">Preview before analysis</span>
                <span class="pill pill-red">Plain-language results</span>
            </div>
            <div class="grid grid-2">
                <div style="background: var(--surface); padding:12px 14px; border-radius:12px;">
                    <strong>What is Benford's Law?</strong>
                    <p class="muted" style="font-size:14px;">In many natural datasets, numbers starting with 1 appear about 30% of the time, while 9s appear less than 5%. Big deviations can signal anomalies.</p>
                </div>
                <div style="background: var(--surface); padding:12px 14px; border-radius:12px;">
                    <strong>Expected distribution</strong>
                    <div style="display:grid; grid-template-columns: repeat(9, 1fr); gap:6px; margin-top:8px;">
                        {% set percents = [30.1,17.6,12.5,9.7,7.9,6.7,5.8,5.1,4.6] %}
                        {% for p in percents %}
                        <div style="text-align:center; font-size:12px;">
                            <div style="height:50px; display:flex; align-items:flex-end; justify-content:center;">
                                <div style="width:12px; height:{{ p/30 * 50 }}px; background: var(--accent); border-radius:6px 6px 2px 2px;"></div>
                            </div>
                            <div style="font-weight:600;">{{ loop.index }}</div>
                            <div class="muted" style="font-size:11px;">{{ p }}%</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        <div class="card" style="flex:1 1 320px; background: #f8f9ff;">
            <h3 style="margin-bottom:10px;">Upload a CSV</h3>
            <form method="post" action="/preview" enctype="multipart/form-data" style="display:flex; flex-direction:column; gap:14px;">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <label style="font-weight:600;">Select CSV File</label>
                <input type="file" name="file" id="file" accept=".csv" required style="padding:12px; border:2px dashed var(--accent); border-radius:10px; background:#fff;">
                <button type="submit" class="btn btn-primary" style="justify-content:center;">Preview Data</button>
            </form>
            <p class="muted" style="margin-top:10px; font-size:13px;">We validate MIME type, size (16MB default), and numeric columns before analysis.</p>
            <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
                <a href="{{ url_for('examples') }}" class="btn btn-secondary">Browse examples</a>
            </div>
        </div>
    </div>

    <div class="section">
        <h3>How it works</h3>
        <div class="grid grid-2" style="margin-top:10px;">
            <div style="background: var(--surface); padding:12px 14px; border-radius:12px;">
                <strong>1) Upload or pick an example</strong>
                <p class="muted" style="font-size:14px;">Use your CSV or start with curated datasets to see conforming and non-conforming patterns.</p>
            </div>
            <div style="background: var(--surface); padding:12px 14px; border-radius:12px;">
                <strong>2) Preview and select a numeric column</strong>
                <p class="muted" style="font-size:14px;">We detect numeric columns and show a 10-row preview so you can choose confidently.</p>
            </div>
            <div style="background: var(--surface); padding:12px 14px; border-radius:12px;">
                <strong>3) Run Benford analysis</strong>
                <p class="muted" style="font-size:14px;">We compute first-digit frequencies, generate a plot, and calculate chi-squared and p-value.</p>
            </div>
            <div style="background: var(--surface); padding:12px 14px; border-radius:12px;">
                <strong>4) Interpret the results</strong>
                <p class="muted" style="font-size:14px;">Get a plain-language explanation plus the detailed report for deeper inspection.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
